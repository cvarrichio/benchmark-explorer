<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart Visualization</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-autocolors"></script>

</head>
<body>
    <div>
        <canvas id="myChart" width="400" height="200"></canvas>
    </div>

    <script>
        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        fetch('/data')
            .then(response => response.json())
            .then(data => {
                // Process your data into a format suitable for Chart.js
                let labels = [];
                let datasets = [];

                for (const [key, value] of Object.entries(data)) {
                    let dates = value.map(item => item.paper_date);
                    let accuracies = value.map(item => item.metrics.Accuracy);

                    labels = dates;
                    datasets.push({
                        label: key,
                        data: accuracies,
                        fill: false,
                        borderColor: getRandomColor(),
                        tension: 0.1
                    });
                }

                //const autocolors = window['chartjs-plugin-autocolors'];
                //Chart.register(autocolors);

                const ctx = document.getElementById('myChart').getContext('2d');
                const myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: datasets
                    },
                    options: {
                        plugins: {
                            //autocolors: {}, // Enable autocolors plugin
                            legend: {
                            position: 'right' // Move legend to the right
                            }
                        },
                        scales: {
                            y: {
                                type: 'linear',
                            },
                        },
                    },
                });
            });
    </script>
</body>
</html>